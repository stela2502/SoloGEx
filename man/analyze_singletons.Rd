% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SoloGEx.R
\name{analyze_singletons}
\alias{analyze_singletons}
\alias{analyze_singletons,SoloGEx,SoloGEx-method}
\title{Analyze singleton samples against reference group statistics}
\usage{
analyze_singletons(single_edat, group_edat, group_col)

\S4method{analyze_singletons}{SoloGEx,SoloGEx}(single_edat, group_edat, group_col = NULL)
}
\arguments{
\item{single_edat}{A \code{SoloGEx} object containing singleton samples.
Expression data should be in \code{@expr}, sample metadata in \code{@colData}.}

\item{group_edat}{A \code{SoloGEx} object containing the reference dataset.
If group statistics are not yet computed, they will be calculated using
\code{compute_group_stats()} internally.}

\item{group_col}{Character string specifying the column in \code{colData} 
that defines biological groups.}
}
\value{
A \code{SoloGEx} object with the \code{singleton_analysis} slot filled:
  \describe{
    \item{\code{z_scores}}{Absolute Z-score of each gene vs closest group.}
    \item{\code{closest_group}}{Name of the reference group with minimum |Z| per gene.}
    \item{\code{overall_dev}}{Mean minimum Z-score per sample, indicating global deviation.}
  }
}
\description{
This function compares singleton (1-sample) datasets to a reference
dataset with group statistics. For each gene in each singleton sample:
it computes absolute Z-scores relative to each reference group,
identifies the "closest" group (smallest |Z|), and calculates an
overall deviation per sample.
}
\details{
Steps performed internally:
\enumerate{
  \item{Check that genes in \code{single_edat} and \code{group_edat} match.}
  \item{Compute group statistics for \code{group_edat} if missing.}
  \item{For each gene in each singleton sample:}
    \itemize{
      \item{Compute Z-score vs mean of each reference group.}
      \item{Identify group with minimum absolute Z-score.}
    }
  \item{Compute overall deviation per sample as the mean of min-Z across genes.}
}

Interpretation for lab scientists:
\itemize{
  \item{High |Z| values indicate genes unusually high or low relative to reference groups.}
  \item{A high \code{overall_dev} for a sample suggests it is globally different from all reference groups.}
  \item{Closest group per gene can guide hypotheses about which baseline the singleton most resembles.}
}
}
\section{Functions}{
\itemize{
\item \code{analyze_singletons(single_edat = SoloGEx, group_edat = SoloGEx)}: Method for SoloGEx objects

}}
\examples{
# Create mock reference dataset
ref_expr <- matrix(rnorm(12), nrow=3, dimnames=list(paste0("Gene",1:3), paste0("R",1:4)))
ref_colData <- data.frame(SampleID = paste0("R",1:4),
                          BiologicalGroup = c("A","A","B","B"))
ref_edat <- SoloGEx(ref_expr, ref_colData)

# Create singleton dataset
singleton_expr <- matrix(rnorm(6), nrow=3, dimnames=list(paste0("Gene",1:3), paste0("S",1:2)))
singleton_colData <- data.frame(SampleID = paste0("S",1:2))
single_edat <- SoloGEx(singleton_expr, singleton_colData)

# Analyze
single_edat <- analyze_singletons(single_edat, ref_edat, group_col="BiologicalGroup")
single_edat@singleton_analysis

}
